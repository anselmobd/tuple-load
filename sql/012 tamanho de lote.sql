-- 36 MD TECELAGEM

UPDATE BASI_020 tt
SET tt.LOTE_FABR_PECAS=36
WHERE tt.BASI030_NIVEL030 = 1
  AND tt.LOTE_FABR_PECAS <> 36
  AND EXISTS
(
SELECT
  t.LOTE_FABR_PECAS
, r.CONTA_ESTOQUE
, r.LINHA_PRODUTO
, t.*
FROM BASI_020 t
JOIN BASI_030 r
  ON r.NIVEL_ESTRUTURA = t.BASI030_NIVEL030
 AND r.REFERENCIA = t.BASI030_REFERENC
WHERE r.CONTA_ESTOQUE IN (10, 12, 14) -- MD
  AND r.LINHA_PRODUTO = 11 -- TECELAGEM
  AND t.BASI030_NIVEL030 = tt.BASI030_NIVEL030
  AND t.BASI030_REFERENC = tt.BASI030_REFERENC
)
;

-- 40 MD COSTURADO

UPDATE BASI_020 tt
SET tt.LOTE_FABR_PECAS=40
WHERE tt.BASI030_NIVEL030 = 1
  AND tt.LOTE_FABR_PECAS <> 40
  AND EXISTS
(
SELECT
  t.LOTE_FABR_PECAS
, r.CONTA_ESTOQUE
, r.LINHA_PRODUTO
, t.*
FROM BASI_020 t
JOIN BASI_030 r
  ON r.NIVEL_ESTRUTURA = t.BASI030_NIVEL030
 AND r.REFERENCIA = t.BASI030_REFERENC
WHERE r.CONTA_ESTOQUE IN (10, 12, 14) -- MD
  AND r.LINHA_PRODUTO = 12 -- COSTURA
  AND t.BASI030_NIVEL030 = tt.BASI030_NIVEL030
  AND t.BASI030_REFERENC = tt.BASI030_REFERENC
)
;

-- 100 PA - INDIVIDUAL EMBALADO & PA - INDIVIDUAL ENCABIDADO

UPDATE BASI_020 tt
SET tt.LOTE_FABR_PECAS=100
WHERE tt.BASI030_NIVEL030 = 1
  AND tt.LOTE_FABR_PECAS <> 100
  AND EXISTS
(
SELECT
  t.LOTE_FABR_PECAS
, r.CONTA_ESTOQUE
, r.LINHA_PRODUTO
, t.*
FROM BASI_020 t
JOIN BASI_030 r
  ON r.NIVEL_ESTRUTURA = t.BASI030_NIVEL030
 AND r.REFERENCIA = t.BASI030_REFERENC
WHERE r.CONTA_ESTOQUE IN (4, 6) -- PA - INDIVIDUAL EMBALADO & PA - INDIVIDUAL ENCABIDADO
  AND t.BASI030_NIVEL030 = tt.BASI030_NIVEL030
  AND t.BASI030_REFERENC = tt.BASI030_REFERENC
)
;

-- 80 PA KIT

UPDATE BASI_020 tt
SET tt.LOTE_FABR_PECAS=80
WHERE tt.BASI030_NIVEL030 = 1
  AND tt.LOTE_FABR_PECAS <> 80
  AND EXISTS
(
SELECT
  t.LOTE_FABR_PECAS
, r.CONTA_ESTOQUE
, r.LINHA_PRODUTO
, t.*
FROM BASI_020 t
JOIN BASI_030 r
  ON r.NIVEL_ESTRUTURA = t.BASI030_NIVEL030
 AND r.REFERENCIA = t.BASI030_REFERENC
WHERE r.CONTA_ESTOQUE = 2 -- PA - KIT
  AND t.BASI030_NIVEL030 = tt.BASI030_NIVEL030
  AND t.BASI030_REFERENC = tt.BASI030_REFERENC
)
;

-- 50 PA %5156% E %2156%

UPDATE BASI_020 tt
SET tt.LOTE_FABR_PECAS=50
WHERE tt.BASI030_NIVEL030 = 1
  AND tt.LOTE_FABR_PECAS <> 50
  AND EXISTS
(
SELECT
  t.LOTE_FABR_PECAS
, r.CONTA_ESTOQUE
, r.LINHA_PRODUTO
, t.*
FROM BASI_020 t
JOIN BASI_030 r
  ON r.NIVEL_ESTRUTURA = t.BASI030_NIVEL030
 AND r.REFERENCIA = t.BASI030_REFERENC
WHERE r.CONTA_ESTOQUE IN (2, 4, 6) -- PA
 AND (  r.REFERENCIA LIKE '%5156%'
     OR r.REFERENCIA LIKE '%2156%'
     )
  AND t.BASI030_NIVEL030 = tt.BASI030_NIVEL030
  AND t.BASI030_REFERENC = tt.BASI030_REFERENC
)
;

-- 50 PA RENNER

UPDATE BASI_020 tt
SET tt.LOTE_FABR_PECAS=50
WHERE tt.BASI030_NIVEL030 = 1
  AND tt.LOTE_FABR_PECAS <> 50
  AND EXISTS
(
SELECT
  t.LOTE_FABR_PECAS
, r.CONTA_ESTOQUE
, r.LINHA_PRODUTO
, t.*
FROM BASI_020 t
JOIN BASI_030 r
  ON r.NIVEL_ESTRUTURA = t.BASI030_NIVEL030
 AND r.REFERENCIA = t.BASI030_REFERENC
WHERE r.CONTA_ESTOQUE IN (2, 4, 6) -- PA
  AND r.CGC_CLIENTE_9 = 092754738
  AND t.BASI030_NIVEL030 = tt.BASI030_NIVEL030
  AND t.BASI030_REFERENC = tt.BASI030_REFERENC
)
;
