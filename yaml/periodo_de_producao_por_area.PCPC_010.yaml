csv:

  columns:
    - AREA_PERIODO
    - PERIODO_PRODUCAO
    - DATA_INI_PERIODO
    - DATA_FIM_PERIODO

  fields:

    AREA_PERIODO:
      type: integer

    PERIODO_PRODUCAO:
      type: integer

  keys:
    - AREA_PERIODO
    - PERIODO_PRODUCAO

sql:

  db: systextil

  key_count: |
    SELECT
      count(DATA_INI_PERIODO)
    FROM PCPC_010
    WHERE AREA_PERIODO = :AREA_PERIODO
      AND PERIODO_PRODUCAO = :PERIODO_PRODUCAO

  update: |
    UPDATE PCPC_010 SET
      DATA_INI_PERIODO = TO_DATE(:DATA_INI_PERIODO, 'DD/MM/YYYY') -- TIMESTAMP '2017-01-01 00:00:00.000000'
    , DATA_FIM_PERIODO = TO_DATE(:DATA_FIM_PERIODO, 'DD/MM/YYYY') -- TIMESTAMP '2017-01-07 00:00:00.000000'
    , CAPAC_PERIODO = 0
    , SITUACAO_PERIODO = 0
    , ESTAGIO_CRITICO = 0
    , ULTIMO_PROGRAMA = 0
    , ULTIMO_LOTE = 0
    , ULTIMO_ORDEM = 0
    , ULTIMO_NUMERO = 0
    , CODIGO_EMPRESA = 1
    , CODIGO_DEPOSITO = 0
    , DIAS_UTEIS = 5
    , PARAMETRO_PLANO = 0
    , LIBERADO_ORD_SERV = 'S'
    , COD_QUINZENA = 1
    , DATA_LIMITE_PROGRAMACAO = TO_DATE(:DATA_FIM_PERIODO, 'DD/MM/YYYY') -- TIMESTAMP '2017-01-07 00:00:00.000000'
    , DATA_INI_FATU = TO_DATE(:DATA_INI_PERIODO, 'DD/MM/YYYY') -- TIMESTAMP '2017-01-01 00:00:00.000000'
    , DATA_FIM_FATU = TO_DATE(:DATA_FIM_PERIODO, 'DD/MM/YYYY') -- TIMESTAMP '2017-01-07 00:00:00.000000'
    , SIT_PER_FATU = 0
    , LIBERADO_PREP_OB = 'S'
    , EXPORTADO = 0
    WHERE AREA_PERIODO = :AREA_PERIODO
      AND PERIODO_PRODUCAO = :PERIODO_PRODUCAO

  insert: |
    INSERT INTO PCPC_010 (
      AREA_PERIODO
    , PERIODO_PRODUCAO
    , DATA_INI_PERIODO
    , DATA_FIM_PERIODO
    , CAPAC_PERIODO
    , SITUACAO_PERIODO
    , ESTAGIO_CRITICO
    , ULTIMO_PROGRAMA
    , ULTIMO_LOTE
    , ULTIMO_ORDEM
    , ULTIMO_NUMERO
    , CODIGO_EMPRESA
    , CODIGO_DEPOSITO
    , DIAS_UTEIS
    , PARAMETRO_PLANO
    , LIBERADO_ORD_SERV
    , COD_QUINZENA
    , DATA_LIMITE_PROGRAMACAO
    , DATA_INI_FATU
    , DATA_FIM_FATU
    , SIT_PER_FATU
    , LIBERADO_PREP_OB
    , EXPORTADO
    ) VALUES (
      :AREA_PERIODO -- 1
    , :PERIODO_PRODUCAO -- 1701
    , TO_DATE(:DATA_INI_PERIODO, 'DD/MM/YYYY') -- TIMESTAMP '2017-01-01 00:00:00.000000'
    , TO_DATE(:DATA_FIM_PERIODO, 'DD/MM/YYYY') -- TIMESTAMP '2017-01-07 00:00:00.000000'
    , 0
    , 0
    , 0
    , 0
    , 0
    , 0
    , 0
    , 1
    , 0
    , 5
    , 0
    , 'S'
    , 1
    , TO_DATE(:DATA_FIM_PERIODO, 'DD/MM/YYYY') -- TIMESTAMP '2017-01-07 00:00:00.000000'
    , TO_DATE(:DATA_INI_PERIODO, 'DD/MM/YYYY') -- TIMESTAMP '2017-01-01 00:00:00.000000'
    , TO_DATE(:DATA_FIM_PERIODO, 'DD/MM/YYYY') -- TIMESTAMP '2017-01-07 00:00:00.000000'
    , 0
    , 'S'
    , 0
    )

  key_list: |
    SELECT
      AREA_PERIODO
    , PERIODO_PRODUCAO
    FROM PCPC_010

  delete: |
    DELETE FROM PCPC_010
    WHERE AREA_PERIODO = :AREA_PERIODO
      AND PERIODO_PRODUCAO = :PERIODO_PRODUCAO
