csv:

  fields:

    CODIGO_ESTAGIO:
      type: integer

  keys:
    - CODIGO_ESTAGIO

sql:

  db: systextil

  key_count: |
    SELECT
      count(e.DESCRICAO)
    from MQOP_005 e
    where e.CODIGO_ESTAGIO = :CODIGO_ESTAGIO

  update: |
    UPDATE MQOP_005 e
    set
      e.DESCRICAO = :DESCRICAO
    , e.CUSTO_MINUTO = 0 -- CUSTO_MINUTO
    , e.CODIGO_DEPOSITO = 0 -- CODIGO_DEPOSITO
    , e.AREA_PRODUCAO = :AREA_PRODUCAO
    , e.NIVEL_ESTAGIO = 0 -- NIVEL_ESTAGIO
    , e.ESTAGIO_FARDO = 0 -- ESTAGIO_FARDO
    , e.LEED_TIME = 0 -- LEED_TIME
    , e.FORMA_CONTROLE = 0 -- FORMA_CONTROLE
    , e.TIPO_ESTAGIO = :TIPO_ESTAGIO
    , e.ESTAGIO_FINAL = :ESTAGIO_FINAL
    , e.AREA_AGRUP_REJ = 1 -- AREA_AGRUP_REJ
    , e.COR_REPRESENTATIVA = '0' -- COR_REPRESENTATIVA
    , e.CONSUMO_TOTAL = 0 -- CONSUMO_TOTAL
    , e.SEQUENCIA_CALCULO_FILA = 0 -- SEQUENCIA_CALCULO_FILA
    , e.ESTAGIO_BASE_FILA = 0 -- ESTAGIO_BASE_FILA
    , e.EST_AGRUP_EST = 0 -- EST_AGRUP_EST
    , e.ENDERECO_AUTOMATICO = 'N' -- ENDERECO_AUTOMATICO
    , e.SEQ_PLANEJAMENTO = :SEQ_PLANEJAMENTO
    , e.TIPO_VALORIZACAO = 1 -- TIPO_VALORIZACAO
    , e.COD_PROCESSO = 0 -- COD_PROCESSO
    , e.CONTROLE_POR_PARTE = 0 -- CONTROLE_POR_PARTE
    , e.CONTROLE_NA_ENTRADA_SAIDA = 0 -- CONTROLE_NA_ENTRADA_SAIDA
    , e.LISTA_INVENTARIO = 0 -- LISTA_INVENTARIO
    , e.TIPO_CALC_ESTQ = 0 -- TIPO_CALC_ESTQ
    , e.EXIGE_COR = 0 -- EXIGE_COR
    where e.CODIGO_ESTAGIO = :CODIGO_ESTAGIO

  insert: |
    INSERT INTO MQOP_005 (
      CODIGO_ESTAGIO
    , DESCRICAO
    , CUSTO_MINUTO
    , CODIGO_DEPOSITO
    , AREA_PRODUCAO
    , NIVEL_ESTAGIO
    , ESTAGIO_FARDO
    , LEED_TIME
    , FORMA_CONTROLE
    , TIPO_ESTAGIO
    , ESTAGIO_FINAL
    , AREA_AGRUP_REJ
    , COR_REPRESENTATIVA
    , CONSUMO_TOTAL
    , SEQUENCIA_CALCULO_FILA
    , ESTAGIO_BASE_FILA
    , EST_AGRUP_EST
    , ENDERECO_AUTOMATICO
    , SEQ_PLANEJAMENTO
    , TIPO_VALORIZACAO
    , COD_PROCESSO
    , CONTROLE_POR_PARTE
    , CONTROLE_NA_ENTRADA_SAIDA
    , LISTA_INVENTARIO
    , TIPO_CALC_ESTQ
    , EXIGE_COR
    ) VALUES (
      :CODIGO_ESTAGIO
    , :DESCRICAO
    , 0 -- CUSTO_MINUTO
    , 0 -- CODIGO_DEPOSITO
    , :AREA_PRODUCAO
    , 0 -- NIVEL_ESTAGIO
    , 0 -- ESTAGIO_FARDO
    , 0 -- LEED_TIME
    , 0 -- FORMA_CONTROLE
    , :TIPO_ESTAGIO
    , :ESTAGIO_FINAL
    , 1 -- AREA_AGRUP_REJ
    , '0' -- COR_REPRESENTATIVA
    , 0 -- CONSUMO_TOTAL
    , 0 -- SEQUENCIA_CALCULO_FILA
    , 0 -- ESTAGIO_BASE_FILA
    , 0 -- EST_AGRUP_EST
    , 'N' -- ENDERECO_AUTOMATICO
    , :SEQ_PLANEJAMENTO
    , 1 -- TIPO_VALORIZACAO
    , 0 -- COD_PROCESSO
    , 0 -- CONTROLE_POR_PARTE
    , 0 -- CONTROLE_NA_ENTRADA_SAIDA
    , 0 -- LISTA_INVENTARIO
    , 0 -- TIPO_CALC_ESTQ
    , 0 -- EXIGE_COR
    )

  key_list: |
    SELECT
      e.CODIGO_ESTAGIO
    from MQOP_005 e

  delete: |
    DELETE FROM MQOP_005 e
    where e.CODIGO_ESTAGIO = :CODIGO_ESTAGIO

  fault_delete: |
    UPDATE MQOP_005 e
    set
      e.DESCRICAO = substr('##' || e.DESCRICAO, 1, 20)
    where e.CODIGO_ESTAGIO = :CODIGO_ESTAGIO
      and e.DESCRICAO not like '##%'
