[read]
master.db=csv
master.filename=_produto_referencias.test.csv
master.select={"keys": ["REFERENCIA"]}

db=f1
sql=
  select
    p.P_COD
  , p.P_DESC descricao
  , case when ' ' || p.p_desc || ' ' like '% KIT %'
    then 91
    else 92
    end conta_estoque
  from dis_pro p
  where p.P_COD = ?

[variables]
nivel_estrutura={"value": "1"}
unidmedida={"value": "UN"}
codigo_contabil={"value": "99", "type": "n"}

linha_produto={"value": "11", "type": "n"}
artigo={"value": "1006", "type": "n"}
colecao={"value": "45", "type": "n"}
classific_fiscal={"value": "61071100"}

[functions]
descricao={"str": {"method": "strip"}}
cod_antigo={"trim": {"field": "p_cod"}}
referencia={"translate":
  { "select": "PA"
  , "type": "t"
  , "default": ""
  , "from": "_produto_referencias.sort.codigos.csv"
  , "where": [["REFERENCIA", "cod_antigo"]]
  }}

[columns]
nivel_estrutura=t
referencia=t
descricao=t
unidmedida=t
conta_estoque=n
codigo_contabil=n
linha_produto=n
artigo=n
colecao=n
classific_fiscal=t
