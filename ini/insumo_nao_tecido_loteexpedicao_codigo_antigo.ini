[read]
master.db=csv
master.filename=_produto_loteexpedicao_referencias.sort.codigos.csv
master.select={"keys": ["REFERENCIA"]}

db=pccon
sql=
  SELECT distinct
    es.CodItemComponente coditemprod
  FROM TAB_Estrutura es
  JOIN TAB_ItemDeProducao ip on ip.CodItemProd = es.CodItemComponente
  WHERE es.coditemprodpai = 'PA'+?
    and es.CodItemComponente NOT LIKE 'DV%'
    and es.CodItemComponente NOT LIKE 'PA%'
    and es.CodItemComponente NOT LIKE 'MD%'
    and ip.CodEspecie <> 'MALHA'
    and ip.CodEspecie <> 'TECIDO'
    and ip.CodEspecie <> 'MICROFIBRA'
    and ip.CodEspecie <> 'INSPECAO'
    -- and ip.CodItemProd NOT LIKE 'MA0%'
    -- and ip.CodItemProd NOT LIKE 'TC%'
    -- and ip.CodTipoDeMaterial = 200
    -- and ip.NivelTopologico = 4
    and REPLACE(REPLACE(ip.DescrItemDeProducao, '-', ''), ' ', '') <> ''

[columns]
CodItemProd=t

[post_process]
external1={ "id": "final", "script": "uniqtuples.py", "args": ["_insumo_nao_tecido_codigo_antigo"] }
sort={ "field": "CodItemProd", "options": ["unique"] }
external2={ "id": "codigos", "script": "insumo_codigos.py", "args": ["9"] }
